# Playbook Templates: Role-Based Access Guide

> Multi-tenant playbook template management with revenue attribution, health monitoring, and A/B testing for Super Users, Brands, and Dispensaries.

---

## ğŸ“‹ Quick Reference

| Role | Access | What They See | Features |
|------|--------|---------------|----------|
| **Super User** | âœ… Full | All orgs | Templates, Health, A/B Tests, Revenue (Global) |
| **Brand Admin** | âœ… Full | Their brand | Templates, Health, A/B Tests, Revenue (Brand only) |
| **Brand Member** | âœ… Read | Their brand | Templates, Health, A/B Tests, Revenue (Brand only) |
| **Dispensary Admin** | âœ… Full | Their location | Templates, Health, A/B Tests, Revenue (Location only) |
| **Dispensary Staff** | âœ… Read | Their location | Templates, Health, A/B Tests, Revenue (Location only) |

---

## ğŸ¯ By Role: How to Use

### Super Users
**Dashboard Path:** `Admin â†’ Playbook Templates`

**What you can do:**
- ğŸ‘ï¸ View all templates across all organizations
- ğŸ“Š Monitor global template performance
- ğŸ§ª Manage A/B tests for all variants
- ğŸ’° Track revenue attribution across customers
- âš ï¸ View health alerts for all templates
- ğŸ” Drill down into any organization's data

**Example Use Cases:**
- Monitor Pro vs Enterprise tier adoption
- Compare which templates generate most revenue
- Decide which template variant to promote globally
- Investigate why a template has low success rate

**Key Metrics You'll See:**
- Executions per template (all orgs combined)
- Success rates globally
- Revenue attributed per template
- A/B test results across test duration

---

### Brand Users (Brand Admin / Brand Member)

**Dashboard Path:** `Sidebar â†’ Template Health`

**What you can do:**
- ğŸ‘ï¸ View templates assigned to your brand only
- ğŸ“Š Monitor YOUR brand's template performance
- ğŸ§ª See A/B test results for your templates
- ğŸ’° Track revenue from your templates
- âš ï¸ Get health alerts for your templates

**Important:** You can ONLY see data for your brand's organization. Data from other brands is hidden.

**Example Use Cases:**
- Check if today's competitive intel template ran successfully
- See how many customers engaged with your templates
- Track revenue generated by your playbook templates
- Monitor which template variant performs better for your brand

**Key Metrics You'll See:**
- Your brand's template execution counts (all dispensaries)
- Your brand's success rates only
- Revenue attributed to your templates
- A/B test performance for your templates

---

### Dispensary Users (Dispensary Admin / Dispensary Staff)

**Dashboard Path:** `Sidebar â†’ Template Health`

**What you can do:**
- ğŸ‘ï¸ View templates assigned to your dispensary only
- ğŸ“Š Monitor YOUR location's template performance
- ğŸ§ª See A/B test results for your templates
- ğŸ’° Track revenue from your location's templates
- âš ï¸ Get health alerts for your dispensary

**Important:** You can ONLY see data for your location's organization. Data from other dispensaries is hidden.

**Example Use Cases:**
- Check if your loyalty template ran successfully today
- See how many customers reached by your templates
- Monitor which playbook version performs better at your location
- Track orders attributed to your template automations

**Key Metrics You'll See:**
- Your location's template execution counts only
- Your location's success rates only
- Revenue attributed to your location's templates
- A/B test performance for your templates

---

## ğŸš€ How to Access

### Via Dashboard Navigation (Recommended)
1. Log in to https://bakedbot.ai/dashboard
2. Look for **"Template Health"** in the left sidebar (under main navigation)
3. Click it
4. You'll automatically see only your organization's data

### Via Direct URL
```
https://bakedbot.ai/dashboard/admin/playbook-templates
```

**Your role determines what you see:**
- Super users â†’ All organizations
- Brands â†’ Only your brand's org
- Dispensaries â†’ Only your location's org

---

## ğŸ“Š Features: What's Available to Everyone

### 1. Template Overview
**Table showing:**
- Template name and tier (Pro/Enterprise)
- Number of assignments (your org only)
- Execution count (last 30 days)
- Success rate (percentage)
- Failure count
- Last execution time

**Use for:** Quick health check on all templates

---

### 2. Template Drill-Down Page
**Click any template to see:**

**Assigned Orgs Tab**
- Which organizations have this template
- Status (active/inactive)
- Assignment date
- Execution stats per org

**Timeline Tab**
- 30-day execution trend chart
- Daily success/failure breakdown
- Visual performance pattern identification

**Recent Executions Tab**
- Last 100 execution records
- Status (success/failed/error)
- Execution time
- Error messages (if failed)

---

### 3. A/B Testing Dashboard
**For templates with active tests:**

- âœ… Compare variant performance
- ğŸ“Š Success rate comparison chart
- ğŸ“ˆ Execution volume breakdown
- ğŸ“‹ Detailed variant statistics
- ğŸ† Winner declaration (when test completes)
- ğŸ“ˆ Statistical significance (chi-square p-value)

**What you can do:**
- Run new A/B test
- Monitor test progress (7-14 days)
- Declare winner when ready
- See recommendations for rollout

---

### 4. Health Alerts
**Three types of alerts:**

1. **Low Success Rate**
   - ğŸŸ¡ Warning: < 80% success rate
   - ğŸ”´ Critical: < 50% success rate

2. **No Recent Execution**
   - Alert if template hasn't run in 24+ hours

3. **High Error Rate**
   - Alert if 10+ failed retries detected

**How you get alerts:**
- Email to your inbox (super users: all orgs, others: your org only)
- Slack post to #alerts channel
- Visible in dashboard when you load the page

---

### 5. Revenue Attribution
**Tracking what templates generate:**

- ğŸ“Š Revenue attributed per template
- ğŸ¯ Orders linked to template execution
- ğŸ’° ROI calculation per template
- ğŸ“ˆ 7-day attribution window

**How it works:**
1. Template executes (triggers playbook)
2. Execution recorded with customer ID
3. Within 7 days, if customer places order
4. Order revenue attributed back to that template
5. ROI calculated: (revenue - cost) / cost

**Example:**
- Template A executes for Customer 123 on Day 1
- Customer 123 places $50 order on Day 4
- $50 attributed to Template A
- Revenue dashboard updates

---

## ğŸ” Data Isolation Guarantee

**Your organization's data is completely isolated:**
- âœ… Server-side enforcement (you can't access other orgs' data)
- âœ… Database queries filtered by your orgId
- âœ… No "view other org" option anywhere
- âœ… Revenue attribution shows only your org

**For brands:** You see only your brand's organization ID

**For dispensaries:** You see only your location's organization ID

**For super users:** You see all organization data (global)

---

## ğŸ“± Common Tasks

### "Check if my template ran today"
1. Go to Template Health
2. Find template in the list
3. Check "Last Executed" column
4. Click template to see recent executions tab

### "Which template generates most revenue?"
1. Go to Template Health
2. Look at execution stats and success rates
3. Higher success rate = more likely to generate revenue
4. Click template â†’ Recent Executions to see customer data

### "Why is this template failing?"
1. Click template name
2. Go to "Recent Executions" tab
3. Find failed runs
4. Look at error message
5. Share error with your technical team

### "Should I use variant A or B?"
1. Click template
2. Go to "A/B Tests" tab
3. Compare success rates
4. Look at statistical significance (p-value)
5. Lower p-value = more confident choice

### "Test my new template variant"
1. Create variant (in Playbooks section)
2. Go to Template Health
3. Click template
4. Start A/B test with variant IDs
5. Let it run for 7-14 days
6. Check results regularly

---

## âš ï¸ Troubleshooting

### "I don't see the Template Health link"
- Check your role (must be brand_admin, brand_member, dispensary_admin, dispensary_staff, or super_user)
- Try direct URL: https://bakedbot.ai/dashboard/admin/playbook-templates
- Contact admin if link still missing

### "I see 0 templates"
- **For brands:** Check that templates are assigned to your organization
- **For dispensaries:** Check that templates are assigned to your location
- **For super users:** This shouldn't happen - contact support

### "Why do I only see my organization's data?"
- This is by design! Brands and dispensaries are restricted to their own org
- Super users can see all organizations
- Contact your brand/account manager to change organization

### "Why is success rate so low?"
- Check recent executions for error messages
- Template might need debugging
- Check if it depends on external API (POS, loyalty, etc.)
- Review template configuration

---

## ğŸ¤ Support & Questions

**For access issues:**
- Contact your admin (brand_admin or dispensary_admin)
- They can verify your role and org assignment

**For template performance:**
- Check the drill-down page
- Review recent executions with errors
- Share findings with your product team

**For A/B testing help:**
- See A/B Tests tab documentation above
- Work with product manager to interpret results

---

## ğŸ“š Related Documentation

- **Playbook System:** [Reference needed - playbook-system.md or similar]
- **A/B Testing Guide:** [Reference needed - ab-testing.md or similar]
- **Role Management:** [Reference needed - roles.md or similar]
- **Revenue Attribution:** [See implementation in playbook-revenue-attribution.ts]

---

## ğŸ”„ Updates & Changes

**Last Updated:** 2026-02-18
**Version:** 1.0 (Initial Release)

**What's New in This Version:**
- âœ… Multi-role access (super users, brands, dispensaries)
- âœ… Org-based data filtering
- âœ… Template health monitoring
- âœ… A/B testing framework
- âœ… Revenue attribution tracking
- âœ… Sidebar navigation for all roles
